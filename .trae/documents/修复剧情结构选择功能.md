# 修复剧情结构选择功能

## 问题分析
剧情结构下拉框不见了，经过代码分析，发现以下问题：
1. `App.tsx` 中缺少剧情结构选择相关的状态管理
2. 没有导入和使用 `PlotStructureModal` 组件
3. 情节架构页面缺少触发剧情结构选择的按钮
4. 生成情节架构时没有使用选择的剧情结构

## 修复方案

### 1. 添加状态管理
在 `App.tsx` 中添加以下状态：
- `showPlotStructureModal`: 控制剧情结构模态框的显示/隐藏
- `selectedPlotStructure`: 存储当前选择的剧情结构

### 2. 导入模态框组件
在 `App.tsx` 中导入 `PlotStructureModal` 组件

### 3. 渲染模态框
在 `App.tsx` 的返回JSX中添加 `PlotStructureModal` 组件的渲染

### 4. 添加触发按钮
在情节架构（PLOT）页面的操作栏中添加选择剧情结构的按钮

### 5. 更新生成逻辑
确保在调用 `handleGenerateStep` 生成情节架构时，将选择的剧情结构作为参数传递

### 6. 更新提示词模板
确保 `PROMPTS.PLOT` 模板中正确使用 `{plot_structure}` 变量

## 实现步骤

1. **修改 App.tsx**：
   - 添加状态管理
   - 导入 PlotStructureModal 组件
   - 渲染 PlotStructureModal 组件
   - 在 PLOT 步骤中添加触发按钮
   - 更新生成逻辑

2. **验证修复**：
   - 运行构建命令确保没有错误
   - 测试剧情结构选择功能
   - 验证生成的情节架构中使用了选择的剧情结构

## 预期效果
- 情节架构页面顶部将显示"选择剧情结构"按钮
- 点击按钮会打开剧情结构选择模态框
- 选择剧情结构后，会在生成情节架构时使用该结构
- 生成的情节架构将按照选择的结构模型组织

## 文件修改
- `App.tsx`: 添加状态管理、导入组件、渲染模态框、添加触发按钮、更新生成逻辑
- 确保 `constants.ts` 中的 `PROMPTS.PLOT` 模板正确使用 `{plot_structure}` 变量