# 实现显示实际传递给AI的提示词功能

## 功能需求
在写作步骤的查看提示词中显示当前实际传递给AI的完整提示词，包括所有变量替换后的内容。

## 实现方案

### 1. 修改App.tsx

#### 1.1 添加状态管理
- 添加`fullPrompt`状态变量，用于存储当前生成的完整提示词
- 添加`isFullPromptView`状态变量，用于控制是否显示完整提示词

#### 1.2 修改handleShowPrompt函数
- 在函数中生成实际的完整提示词（使用formatPrompt）
- 保存到fullPrompt状态
- 设置isFullPromptView为false（默认显示模板）

#### 1.3 修改PromptEditorModal调用
- 传递fullPrompt和isFullPromptView状态
- 添加切换视图的回调函数

### 2. 修改Modals.tsx

#### 2.1 修改PromptEditorModal组件
- 添加fullPrompt和isFullPromptView属性
- 添加切换视图的回调函数属性
- 在组件中添加选项卡或切换按钮
- 根据isFullPromptView状态显示模板或完整提示词

#### 2.2 添加完整提示词显示区域
- 添加一个新的选项卡，标题为"实际提示词"或"完整提示词"
- 在该选项卡中显示fullPrompt内容
- 添加复制按钮，方便用户复制完整提示词

### 3. 生成完整提示词的逻辑

在handleShowPrompt函数中，根据当前步骤和生成的数据，构建完整的变量对象，然后使用formatPrompt函数生成完整提示词。

对于不同的步骤，需要构建不同的变量对象：
- 创作初始化：基础变量（主题、题材等）
- 核心DNA：主题、题材、基调等
- 角色动力学：包含核心DNA
- 世界观构建：包含核心DNA和角色动力学
- 情节架构：包含核心DNA、角色动力学和世界观
- 章节蓝图：包含情节架构
- 角色状态库：包含角色动力学
- 正文创作：包含所有前置数据

## 预期效果

- 当用户点击查看提示词时，提示词编辑器会默认显示模板提示词
- 用户可以通过选项卡切换查看实际传递给AI的完整提示词
- 完整提示词中所有变量都已被替换为实际值
- 完整提示词区域提供复制功能

## 文件修改

- `App.tsx`：添加状态和修改函数
- `components/Modals.tsx`：修改PromptEditorModal组件
- 可能需要修改其他相关组件，确保变量对象构建正确

## 实现步骤

1. 在App.tsx中添加必要的状态
2. 修改handleShowPrompt函数，生成完整提示词
3. 更新PromptEditorModal组件，添加完整提示词显示功能
4. 测试各步骤的完整提示词生成是否正确
5. 优化UI，确保切换功能易用

这个方案将确保用户能够查看当前实际传递给AI的完整提示词，提高了系统的透明度和易用性。